<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="区块链的共识算法创建时间：2020年2月18日 更新时间：2020年2月26日 作者：ShizhiDeng 更新内容：  2020-02-25  1重新生成每个算法的总结图，重新整理文章，并发布  2020-02-26 1231. 投票直接形成共识的BFT类2. 选举代理人间接参与共识的代理类3. DAG类共识  2020-02-27  12345  1. 我的思考更新  2. 增加共识算法的分类">
<meta name="keywords" content="区块链,共识算法">
<meta property="og:type" content="article">
<meta property="og:title" content="区块链的共识算法">
<meta property="og:url" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/index.html">
<meta property="og:site_name" content="DengShizhi">
<meta property="og:description" content="区块链的共识算法创建时间：2020年2月18日 更新时间：2020年2月26日 作者：ShizhiDeng 更新内容：  2020-02-25  1重新生成每个算法的总结图，重新整理文章，并发布  2020-02-26 1231. 投票直接形成共识的BFT类2. 选举代理人间接参与共识的代理类3. DAG类共识  2020-02-27  12345  1. 我的思考更新  2. 增加共识算法的分类">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结_我的思考.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-all.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-分类标准.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-PoX类.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-PoW.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-PoS.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-PoA.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-PoA.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-Casper.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-Ouroboros.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-PoSV.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-otherPoX.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-BFT类共识机制.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-pBFT.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/pBFT.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-FBA.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-代理类共识机制.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-DPoS.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-DPoS_BFT.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结-DAG类共识机制.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法对比.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/Consensus%20in%20Hyperledger%20Fabric.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/Consensus%20in%20Hyperledger%20Indy.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/Consensus%20in%20Hyperledger%20Indy2.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/Consensus%20in%20Hyperledger%20Iroha.png">
<meta property="og:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/Consensus%20in%20Hyperledger%20Iroha2.png">
<meta property="og:updated_time" content="2020-02-26T10:01:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="区块链的共识算法">
<meta name="twitter:description" content="区块链的共识算法创建时间：2020年2月18日 更新时间：2020年2月26日 作者：ShizhiDeng 更新内容：  2020-02-25  1重新生成每个算法的总结图，重新整理文章，并发布  2020-02-26 1231. 投票直接形成共识的BFT类2. 选举代理人间接参与共识的代理类3. DAG类共识  2020-02-27  12345  1. 我的思考更新  2. 增加共识算法的分类">
<meta name="twitter:image" content="http://www.atopos.cc/2020/02/25/区块链的共识算法/区块链的共识算法总结_我的思考.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>区块链的共识算法</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">archives</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/02/25/区块链和云计算/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020/02/14/Technical Analysis of Hyperledger/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.atopos.cc/2020/02/25/区块链的共识算法/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&text=区块链的共识算法"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&is_video=false&description=区块链的共识算法"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=区块链的共识算法&body=Check out this article: http://www.atopos.cc/2020/02/25/区块链的共识算法/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&name=区块链的共识算法&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#区块链的共识算法"><span class="toc-number">1.</span> <span class="toc-text">区块链的共识算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#我的思考（持续更）"><span class="toc-number">1.1.</span> <span class="toc-text">我的思考（持续更）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#共识算法的分类方法1"><span class="toc-number">1.2.</span> <span class="toc-text">共识算法的分类方法1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4类共识机制简析"><span class="toc-number">1.3.</span> <span class="toc-text">4类共识机制简析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#共识机制对比"><span class="toc-number">1.4.</span> <span class="toc-text">共识机制对比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#共识算法的分类方法2[^_2_]"><span class="toc-number">1.5.</span> <span class="toc-text">共识算法的分类方法2[^ 2 ]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consensus_in_Hyperledger_Fabric(Kafka_in_Fabric_v1)[^_2_][^_3_][^_4_]"><span class="toc-number">1.6.</span> <span class="toc-text">Consensus in Hyperledger Fabric(Kafka in Fabric v1)[^ 2 ][^ 3 ][^ 4 ]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consensus_in_Hyperledger_Indy_(based_on_RBFT)"><span class="toc-number">1.7.</span> <span class="toc-text">Consensus in Hyperledger Indy (based on RBFT)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consensus_in_Hyperledger_Iroha(Sumeragi:based_on_BFT)"><span class="toc-number">1.8.</span> <span class="toc-text">Consensus in Hyperledger Iroha(Sumeragi:based on BFT)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consensus_in_Hyperledger_Sawtooth(based_on_PoET)"><span class="toc-number">1.9.</span> <span class="toc-text">Consensus in Hyperledger Sawtooth(based on PoET)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Paxos"><span class="toc-number">1.10.</span> <span class="toc-text">Paxos</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        区块链的共识算法
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">DengShizhi</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-02-25T08:09:00.000Z" itemprop="datePublished">2020-02-25</time>
        
        (Updated: <time datetime="2020-02-26T10:01:00.000Z" itemprop="dateModified">2020-02-26</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/区块链/">区块链</a> › <a class="category-link" href="/categories/区块链/共识算法/">共识算法</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/共识算法/">共识算法</a>, <a class="tag-link" href="/tags/区块链/">区块链</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="区块链的共识算法">区块链的共识算法</h1><p>创建时间：2020年2月18日</p>
<p>更新时间：2020年2月26日</p>
<p>作者：ShizhiDeng</p>
<p>更新内容：</p>
<ul>
<li><p>2020-02-25 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">重新生成每个算法的总结图，重新整理文章，并发布</span><br></pre></td></tr></table></figure>
</li>
<li><p>2020-02-26</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 投票直接形成共识的BFT类</span><br><span class="line">2. 选举代理人间接参与共识的代理类</span><br><span class="line">3. DAG类共识</span><br></pre></td></tr></table></figure>
<ul>
<li>2020-02-27</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  1. 我的思考更新</span><br><span class="line">  2. 增加共识算法的分类方法2 更新hyperledger部分</span><br><span class="line">  3. Consensus in Hyperledger Fabric(Kafka in Fabric v1)</span><br><span class="line">4. Consensus in Hyperledger Indy (based on RBFT)</span><br><span class="line">  5. Consensus in Hyperledger Iroha(Sumeragi:based on BFT)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="我的思考（持续更）">我的思考（持续更）</h2><ul>
<li>Why consensus?<br>The goal of consensus is to generate an agreement on the order and to validate the correctness of the set of transactions that constitute the block.<ul>
<li>agreement of transaction</li>
<li>validation of transaction</li>
</ul>
</li>
<li>Core function of consensus<ul>
<li>Confirms the correctness of all transactions in a proposed block.</li>
<li>Agrees on order and correctness and hence on results of execution (implies agreement on global state).</li>
<li>Interfaces and depends on smart-contract layer to verify correctness of an ordered set of transactions in a block.</li>
</ul>
</li>
<li><p>Consensus Properties[^ 2 ]</p>
<ul>
<li>Safety: each node is guaranteed the same sequence of inputs and results in the same output on each node. (同一个输入，得到同一个输出)</li>
<li>Liveness: each non-faulty node will eventually receive every submitted transaction, assuming that communication does not fail.</li>
</ul>
</li>
<li><p>节点有相应的概率被选为某个区块的生产者(取得记账权)，在符合一定规则的前提下，由该节点决定区块的内容，再经其 他节点验证。生产合法区块的节点通常可以获得一定的激励。</p>
</li>
<li><p>共识算法：解决一致性问题</p>
</li>
</ul>
<p><img src="区块链的共识算法总结_我的思考.png" alt="区块链的共识算法总结_我的思考"></p>
<h2 id="共识算法的分类方法1">共识算法的分类方法1</h2><p>根据容错，节点参与共识过程的资格，形成共识的依据和共识的内容可以分成四类<a href="[主流区块链共识机制的简介与比较](http://pdf.dfcfw.com/pdf/H3_AP201812271279983589_1.pdf)">^ 1 </a>:</p>
<ul>
<li>Proof of X类</li>
<li>投票直接形成共识的BFT类</li>
<li>选举代理人间接参与共识的代理类</li>
<li>舍弃传统区块概念的DAG类共识</li>
</ul>
<p>整体分类图见下：</p>
<p><img src="区块链的共识算法总结-all.png" alt="区块链的共识算法总结-分成四类"></p>
<p>共识机制的分类标准见下：</p>
<p><img src="区块链的共识算法总结-分类标准.png" alt="区块链的共识算法总结-分类标准"></p>
<h2 id="4类共识机制简析">4类共识机制简析</h2><ol>
<li>Proof of X类共识机制<br>节点获得记账权的概率与该节点拥有某种资源的比例相关，并且这种资源是难以垄断的，同时需要一个能够快速验证某个节点确实拥有这部分资源的算法。<br>该类共识算法有PoW、PoS、PoA/PoSV/Casper、PoST/Proof of Authority：</li>
</ol>
<p><img src="区块链的共识算法总结-PoX类.png" alt="区块链的共识算法总结-PoX类"></p>
<p>   针对PoX类共识机制，分别对上述几种算法总结如下：</p>
<ul>
<li><p>PoW</p>
<p><img src="区块链的共识算法总结-PoW.png" alt="区块链的共识算法总结-PoW"></p>
<ul>
<li><p>PoS<br><img src="区块链的共识算法总结-PoS.png" alt="区块链的共识算法总结-PoS"></p>
</li>
<li><p>PoA<br><img src="区块链的共识算法总结-PoA.png" alt="区块链的共识算法总结-PoA"></p>
</li>
<li><p>PoA<br><img src="区块链的共识算法总结-PoA.png" alt="区块链的共识算法总结-PoA"></p>
</li>
<li><p>Casper<br><img src="区块链的共识算法总结-Casper.png" alt="区块链的共识算法总结-Casper"></p>
</li>
<li><p>Ouroboros<br><img src="区块链的共识算法总结-Ouroboros.png" alt="区块链的共识算法总结-Ouroboros"></p>
</li>
<li><p>PoSV<br><img src="区块链的共识算法总结-PoSV.png" alt="区块链的共识算法总结-PoSV"></p>
</li>
<li><p>其他PoX<br><img src="区块链的共识算法总结-otherPoX.png" alt="区块链的共识算法总结-otherPoX"></p>
</li>
</ul>
</li>
</ul>
<ol>
<li><p>投票直接形成共识的BFT类</p>
<p>该类共识算法有pBFT、dBFT和FBA：<br><img src="区块链的共识算法总结-BFT类共识机制.png" alt="区块链的共识算法总结-BFT类共识机制"></p>
<ul>
<li><p>pBFT</p>
<p><img src="区块链的共识算法总结-pBFT.png" alt="区块链的共识算法总结-pBFT"></p>
<ul>
<li><p>1999年提出，首个高效解决拜占庭容错问题的算法</p>
</li>
<li><p>Hyperledger Fabric曾采用过此共识算法</p>
</li>
<li><p>解决的问题：分布式系统的一致性问题，拜占庭容错问题。</p>
</li>
<li><p>采用的方法：引入“视图”(View)和“主从节点”(Replica)的概念。 Replica 包括主节点(Primary)以及备份节点(Backups)，主节点通常在每一轮共识过程开始时随机选取或者轮流担任。“视图”表示一次主节点分发请求的过程。</p>
<p>当一轮共识开始时，首先检查主节点的有效性。如果备份节点检测到主节点失效，需要选举出新的主节点，称为“视图更换”。共识过程分为包括预准备、准备、确认阶段，又称<strong>“</strong>三阶段协议<strong>”</strong>。</p>
<p><img src="pBFT.png" alt="截屏2020-02-26下午4.41.24"></p>
</li>
<li><p>容错能力：<strong>pBFT</strong> 算法对于一个 <strong>n=3f+1</strong> 个节点组成的区块链网络，可以提供 <strong>f</strong> 的容错能力，容错能力近似为 <strong>1/3</strong>。</p>
</li>
<li><p>pBFT的限制：由于一轮共识过程中节点间的通信次数与𝑛^2^（n为节点数）成正比，考虑到通信延迟的存在，当节点的数量达到一定规模后，<strong>pBFT</strong> 的效率会严重下降。</p>
</li>
</ul>
</li>
<li><p>FBA（Federated Byzantine Agreement 基于联邦拜占庭协议的共识机制）<br><img src="区块链的共识算法总结-FBA.png" alt="区块链的共识算法总结-FBA"></p>
<ul>
<li>思想：通过一种在子网络内部形成信 任(即联邦)，将子网络作为整体视为网络的节点的协议。</li>
<li>基于FBA的共识机制：基于 FBA 的共识机制有RPCA(瑞波共识机制)、恒星共识机制等。</li>
<li>方法：<ul>
<li>RPCA(瑞波共识机制)：节点分验证节点（信任节点列表：UNL Unique Node list）+非验证节点；共识过程分两个阶段：阶段1. 形成交易集的共识（对每一个交易在 UNL 中投票表决，最终得到 80% 投票的交易会被放入交易集中） 阶段2. 形成新区块的共识（广播区块的hash值，比例最高的 Hash值占比超过80%，则达成共识）</li>
<li>恒星共识机制：与 RPCA 类似，恒星共识机制的特点是通过节点可以自由地选择要加入的“联邦”，无需中心化的组织预先选出“服务节点”。</li>
</ul>
</li>
<li>容错能力：RPCA(瑞波共识机制)为1/5。</li>
</ul>
</li>
</ul>
</li>
<li><p>选举代理人间接参与共识的代理类</p>
<ul>
<li><p>BFT类共识机制的限制：参与共识的节点数量有限制，或者参与共识的部分节点必须是可信任的。</p>
</li>
<li><p>目标：一些公共区块链希望尽可能多的节点参与到共识过程中去。</p>
</li>
<li><p>代理共识机制的思想：借鉴现实社会中的选举，网络定期按照节点的得票数选出一定数量的“共识节点”，仅由共识节点完成区块链网络的共识过程。</p>
</li>
<li><p>限制</p>
<ul>
<li>由于见证人的数量有限并且公开，攻击者想要发动DDoS攻击较为容易，见证人需要额外的保护措施，增加了运行共识节点的成本。</li>
<li>具有投票权的节点通常有更大的话语权，甚至可以操纵投票结果。<ul>
<li>如果限制节点的最高投票权重，也可以通过转移通证到不同的节点来规避。 </li>
<li>如果实行“一节点一票”的机制，又会导致“女巫攻击”变得可行。</li>
<li>寻找一个平衡安全性与非中心化的投票算法是较为困难的。</li>
</ul>
</li>
</ul>
</li>
<li><p>该类共识算法有DPoS和DPoS-BFT：<br><img src="区块链的共识算法总结-代理类共识机制.png" alt="区块链的共识算法总结-代理类共识机制"></p>
</li>
<li><p>DPoS</p>
<p><img src="区块链的共识算法总结-DPoS.png" alt="区块链的共识算法总结-DPoS"></p>
<ul>
<li>方法：<ul>
<li>选举见证人：选票前 101 名的节点获得参与网络共识过程的资格，被称为“见证人”。</li>
<li>每个见证人按照一定的顺序(比如随机)轮流获得生产区块的机会，再根据一定的规则对区块链达成共识。</li>
<li>共识方法：根据类似 PoW 的最长链原则选择在高度最高的区块后添加自己的区块。</li>
<li>注意1：各见证人的记账权利是相同的，不因获票数的多少产生区别。</li>
<li>注意2：见证人未能履行义 务或作出不符合整体利益的行为，见证人会被取消记账权。</li>
</ul>
</li>
</ul>
</li>
<li><p>DPoS-BFT</p>
<p><img src="区块链的共识算法总结-DPoS_BFT.png" alt="区块链的共识算法总结-DPoS_BFT"></p>
<ul>
<li>思想：见证人根据获得获得权益支持的多少选出，见证人形成共识的算法可以是 <strong>BFT</strong> 或其他算法。</li>
<li>方法：<ul>
<li>EOS 使用的 DPoS-BFT 共识机制方法：<ul>
<li>股权投票选举出见证人(<strong>EOS</strong> 称为 <strong>BP</strong>，<strong>Block Producer</strong>)的基础上</li>
<li>使用 <strong>BFT</strong> 类算法在 <strong>BP</strong> 之间形成共识。</li>
<li>见证人 21 名，在BFT的三阶段协议中，区块得到15个BP的确认就可最终确认。</li>
</ul>
</li>
<li>NEO 的方法：主要是对见证人形成共识的BFT类算法进行改进<ul>
<li>NEO 网络中有两种通证，管理通证 NEO 以及燃料通证 GAS。</li>
<li>节点根据持有管理通证的份额获得相应数量的选票，选举出一定数量的见证人(共识节点)</li>
<li>由见证人通过改进的pBFT 算法形成共识，生产区块</li>
<li>区块中会有奖励的燃料通证，按持有 NEO 的比例分配给各节点。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>DAG类共识</p>
<p>该类共识算法有如下特点：<br><img src="区块链的共识算法总结-DAG类共识机制.png" alt="区块链的共识算法总结-DAG类共识机制"></p>
<ul>
<li>思想：一般节点维护的交易历史是一个区块组成的哈希链表，特点是单向、线性。修改这种数据结构为IOTA 就是采用有向无环图 DAG (Directed Acyclic Graph)作为记录交易历史的数据结构。</li>
<li>特点和优势：<ul>
<li>Tangle 共识不需要专门负责记账的矿工，而是由新交易给历史交易提供验证，因此不需要交易费用。</li>
<li>不需要将交易打包成区块，交易得到确认的速度取决于新交易 加入Tangle的速度。</li>
</ul>
</li>
<li>缺点<ul>
<li>对交易缺乏过滤机制，因此容易遭到大量垃圾交易的攻击，并且没有有效的机制过滤作恶的节点</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="共识机制对比">共识机制对比</h2><p><img src="区块链的共识算法对比.png" alt="截屏2020-02-26下午6.36.41"></p>
<h2 id="共识算法的分类方法2[^_2_]">共识算法的分类方法2[^ 2 ]</h2><ul>
<li>lottery-based algorithms<ul>
<li>advantages: scale to a large number of nodes since the winner of the lottery proposes a block and transmits it to the rest<br>of the network for validation. </li>
<li>disadvantages: lead to forking when two “winners” propose a block. fork must be resolved, which results in a longer time to finality.</li>
</ul>
</li>
<li>voting-based algorithms<ul>
<li>advantages: low-latency finality</li>
<li>disadvantages: the more nodes that exist on the network, the more time it takes to reach consensus. This results in a trade-off between scalability and speed.</li>
</ul>
</li>
</ul>
<h2 id="Consensus_in_Hyperledger_Fabric(Kafka_in_Fabric_v1)[^_2_][^_3_][^_4_]">Consensus in Hyperledger Fabric(Kafka in Fabric v1)[^ 2 ][^ 3 ][^ 4 ]</h2><ul>
<li>Consensus in Hyperledger Fabric is broken out into 3 phases:<ol>
<li>Endorsement: Endorsement is driven by policy (eg m out of n signatures) upon which participants endorse a transaction.</li>
<li>Ordering: Ordering phase accepts the endorsed transactions and agrees to the order to be committed to the ledger.</li>
<li>Validation: Validation takes a block of ordered transactions and validates the correctness of the results, including checking endorsement policy and double-spending.</li>
</ol>
</li>
<li>ILLUSTRATION OF ONE POSSIBLE TRANSACTION FLOW(COMMON-CASE PATH) IN HYPERLEDGER FABRIC<br><img src="Consensus in Hyperledger Fabric.png" alt="截屏2020-02-27下午4.56.35"></li>
<li>可插拔的共识服务：pluggable consensus service<ul>
<li>the ordering service API allows plugging in BFT-based agreement algorithms</li>
</ul>
</li>
<li>The ordering service API consists of two basic operations: broadcast and deliver.<ul>
<li>broadcast(blob)</li>
<li>deliver(seqno, prevhash, blob)</li>
</ul>
</li>
<li>Multiple ordering plugins are being developed currently, including BFT Smart, Simplified Byzantine Fault Tolerance (SBFT), Honey Badger of BFT, etc.</li>
<li>Fabric v1, Apache Kafka is provided out-of-the-box as a reference implementation.</li>
</ul>
<h2 id="Consensus_in_Hyperledger_Indy_(based_on_RBFT)">Consensus in Hyperledger Indy (based on RBFT)</h2><ul>
<li>Consensus in Hyperledger Indy is based on Redundant Byzantine Fault Tolerance (RBFT)</li>
<li>Like PBFT, RBFT needs at least 3f+1 nodes to handle f faulty nodes. </li>
<li>RBFT overview:<br><img src="Consensus in Hyperledger Indy.png" alt="截屏2020-02-27下午5.23.15"></li>
<li>RBFT protocol steps:<br><img src="Consensus in Hyperledger Indy2.png" alt="截屏2020-02-27下午5.24.33"></li>
</ul>
<h2 id="Consensus_in_Hyperledger_Iroha(Sumeragi:based_on_BFT)">Consensus in Hyperledger Iroha(Sumeragi:based on BFT)</h2><ul>
<li>Insipered by B-Chain Algorithm described by Duan, Meling, Peisert, &amp; Zhang (2014).</li>
<li>Concept of a global order over validating peers and sets A and B of peers, where A consists of the first 2f+1 peers and B consists of the remainder.<br><img src="Consensus in Hyperledger Iroha.png" alt="截屏2020-02-27下午5.30.17"></li>
<li>The order of processing nodes is determined based on the server reputation system called hijiri. </li>
<li>The case of a failure in the proxy tail is shown in Figure below<br><img src="Consensus in Hyperledger Iroha2.png" alt="截屏2020-02-27下午5.35.24"></li>
<li>Consensus in Sumeragi is performed on individual transactions and on the global state resulting from the application of the transaction. When a validating peer receives a transaction over the network, it performs the following steps in order:<ol>
<li>Validate the signature (or signatures, in the case of multi-signature transactions) of the transaction.</li>
<li>Validate the contents of the transaction, where applicable. For example, transfer transactions must leave the payer’s account with a non-negative balance.</li>
<li>Temporarily apply the transaction to the ledger. This involves updating the Merkle root of the global state.</li>
<li>Sign the updated Merkle root and the hash of the transaction contents.</li>
<li>Broadcast the tuple, which is a finite ordered list of transactions.</li>
<li>When syncing nodes with each other, valid parts of the Merkle tree are shared until the roots match.</li>
</ol>
</li>
</ul>
<h2 id="Consensus_in_Hyperledger_Sawtooth(based_on_PoET)">Consensus in Hyperledger Sawtooth(based on PoET)</h2><ul>
<li>PoET: Proof of Elapsed Time </li>
<li>Hyperledger Sawtooth facilitates pluggable consensus for both lottery and voting algorithms. </li>
<li>Default algorithm: lottery-based, Nakamoto consensus algorithm called PoET. </li>
<li>PoET uses a lottery for leader election based on a guaranteed wait time provided through a Trusted Execution Environment (TEE) (Sandell, Bowman, &amp; Shah, 2016). The current implementation of Hyperledger Sawtooth builds on a TEE provided by Intel’s Software Guard Extensions (SGX). </li>
<li>A good lottery function satisfies:<ul>
<li>Fairness - The function should distribute leader election across the broadest possible population of participants.</li>
<li>Investment - The cost of controlling the leader election process should be proportional to the value gained from it.</li>
<li>Verification - It should be relatively simple for all participants to verify that the leader was legitimately selected.</li>
</ul>
</li>
</ul>
<h2 id="Paxos">Paxos</h2><p>[^ 2 ]: Hyperledger Architecture, Volume 1 Introduction to Hyperledger Business Blockchain Design Philosophy and Consensus</p>
<p>[^ 3 ]: <a href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/txflow.html" target="_blank" rel="noopener">Fabric Transaction Flow</a></p>
<p>[^ 4 ]: <a href="https://www.skcript.com/svr/consensus-hyperledger-fabric/" target="_blank" rel="noopener">The Ultimate Guide to Consensus in Hyperledger Fabric</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">archives</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#区块链的共识算法"><span class="toc-number">1.</span> <span class="toc-text">区块链的共识算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#我的思考（持续更）"><span class="toc-number">1.1.</span> <span class="toc-text">我的思考（持续更）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#共识算法的分类方法1"><span class="toc-number">1.2.</span> <span class="toc-text">共识算法的分类方法1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4类共识机制简析"><span class="toc-number">1.3.</span> <span class="toc-text">4类共识机制简析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#共识机制对比"><span class="toc-number">1.4.</span> <span class="toc-text">共识机制对比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#共识算法的分类方法2[^_2_]"><span class="toc-number">1.5.</span> <span class="toc-text">共识算法的分类方法2[^ 2 ]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consensus_in_Hyperledger_Fabric(Kafka_in_Fabric_v1)[^_2_][^_3_][^_4_]"><span class="toc-number">1.6.</span> <span class="toc-text">Consensus in Hyperledger Fabric(Kafka in Fabric v1)[^ 2 ][^ 3 ][^ 4 ]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consensus_in_Hyperledger_Indy_(based_on_RBFT)"><span class="toc-number">1.7.</span> <span class="toc-text">Consensus in Hyperledger Indy (based on RBFT)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consensus_in_Hyperledger_Iroha(Sumeragi:based_on_BFT)"><span class="toc-number">1.8.</span> <span class="toc-text">Consensus in Hyperledger Iroha(Sumeragi:based on BFT)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consensus_in_Hyperledger_Sawtooth(based_on_PoET)"><span class="toc-number">1.9.</span> <span class="toc-text">Consensus in Hyperledger Sawtooth(based on PoET)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Paxos"><span class="toc-number">1.10.</span> <span class="toc-text">Paxos</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.atopos.cc/2020/02/25/区块链的共识算法/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&text=区块链的共识算法"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&is_video=false&description=区块链的共识算法"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=区块链的共识算法&body=Check out this article: http://www.atopos.cc/2020/02/25/区块链的共识算法/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&title=区块链的共识算法"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.atopos.cc/2020/02/25/区块链的共识算法/&name=区块链的共识算法&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 DengShizhi
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">archives</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-101731332-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
